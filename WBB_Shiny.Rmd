---
title: "PracShiny"
author: "Greg"
date: "2024-05-19"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = "/Users/gregorylederer/Desktop/UNC WBB/24-25 Prac/Shiny/To Be Published")
```

#packages
```{r}
library(shiny)
library(shinydashboard)
library(shinyjs)
library(shinythemes)
library(shinyWidgets)
library(glue)
library(dplyr)
library(tidyverse)
library(gt)
library(gtExtras)
library(scales)
library(paletteer)
library(ggplot2)
library(ggforce)
library(tidyr)
```

#funtions
```{r}
tbl_image_df <- data.frame(Jordan = 'https://i.ebayimg.com/images/g/KKcAAOSw6H5aldKt/s-l1200.jpg', UNC = 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcS4mzq28OohMYhB1tErXqobuNlBt2pdAM_OLdJaCwxVkA&s', Heel = 'https://pbs.twimg.com/media/GNuc3G1XoAA8TIz?format=png&name=240x240')
BASIC_TABLES <- function(data) {
  data[is.na(data)] = 0
  data <- data %>% select(image, Player, Points, Reb, Ast, Rim, Rim., Mid, Mid., Three, Three., Off_reb, Def_reb, Stl, Blk, Tov)
  return(data)
}
daily_table2 <- function(data) {
  data[is.na(data)] = 0
  data <- data %>% select(image, Player, Points, PPS, FG, FG., eFG., Two, Two., Three, Three., Ast_Tov, Ast_FGA)
  return(data)
}
WMT_Eff <- function(data) {
  data[is.na(data)] = 0
  data <- data %>% select(image, Player, Points, PPS, FG, FG., eFG., Two, Two., Three, Three., Ast_Tov, Ast_FGA, Rim_att, Mid_att, Three_att)
  return(data)
}
LineChart <- function(data) {
  data <- data %>%
    mutate(num = row_number(),
           Two. = round((Two_make/Two_att)*100,1)) %>%
    rename(
      Assists = Ast,
      Rebounds = Reb,
      'Offensive Rebounds' = Off_reb,
      'Defensive Rebounds' = Def_reb,
      'Rim Makes' = Rim_make,
      'Rim Attempts' = Rim_att,
      'Mid Makes' = Mid_make,
      'Mid Attempts' = Mid_att,
      '3pt Makes' = Three_make,
      '3pt Attempts' = Three_att,
      '2pt Makes' = Two_make,
      '2pt Attempts' = Two_att,
      'Shots Made' = FG_make,
      'Shots Attempted' = FG_att,
      Steals = Stl,
      Blocks = Blk, 
      Turnovers = Tov, 
      'Rim%' = Rim.,
      'Mid%' = Mid.,
      '3pt%' = Three.,
      '2pt%' = Two.,
      'FG%' = FG.,
      'eFG%' = eFG.,
      'Rim Attempt Rate' = Rim_att_rate,
      'Mid Attempt Rate' = Mid_att_rate,
      '3pt Attempt Rate' = Three_att_rate,
      'Points per Shot' = PPS,
      'Assists per 100 Turnovers' = Ast_Tov,
      'Assists per 100 FGA' = Ast_FGA
    )
  return(data)
}
Radar1_1 <- function(data) {
  data <- data %>%
    mutate(
      Points_rank = dense_rank(Points),
      Reb_rank = dense_rank(Reb),
      Ast_rank = dense_rank(Ast),
      Off_reb_rank = dense_rank(Off_reb),
      Def_reb_rank = dense_rank(Def_reb),
      Tov_rank = dense_rank(desc(Tov)),
      Stl_rank = dense_rank(Stl),
      Blk_rank = dense_rank(Blk)
    ) %>%
    select(Player, all_of(ends_with('_rank')))
  return(data)
}
Radar1_2 <- function(data) {
  end_data <- data.frame(Stat = c('PTS', 'AST', 'REB', 'ORB', 'DRB', 'TOV', 'STL', 'BLK'),
                         Value = c(data$Points_rank[1], data$Ast_rank[1], data$Reb_rank[1], data$Off_reb_rank[1], data$Def_reb_rank[1], data$Tov_rank[1], data$Stl_rank[1], data$Blk_rank[1]))
  return(end_data)
}
Radar2 <- function(data,averages) {
  averages <- averages[-15,]
  end_data <- data.frame(Stat = c('eFG%', 'FG%', 'Rim%', 'Mid%', '2pt%', '3pt%'),
                         Value = c(data$eFG.[1], data$FG.[1], data$Rim.[1], data$Mid.[1], data$Two.[1], data$Three.[1]),
                         Avg = c(mean(averages$eFG.), mean(averages$FG.), mean(averages$Rim.), mean(averages$Mid.), mean(averages$Two.), mean(averages$Three.)))
  return(end_data)
}
Scatter <- function(data) {
  data <- data[,-1]
  data <- data %>%
    separate(Rim, into = c("Rim Makes", "Rim Attempts"), sep = "/", convert = TRUE) %>%
    separate(Mid, into = c("Mid Makes", "Mid Attempts"), sep = "/", convert = TRUE) %>%
    separate(Three, into = c("3pt Makes", "3pt Attempts"), sep = "/", convert = TRUE) %>%
    separate(Two, into = c("2pt Makes", "2pt Attempts"), sep = "/", convert = TRUE) %>%
    separate(FG, into = c("FG Makes", "FG Attempts"), sep = "/", convert = TRUE) %>%
    rename(
      Rebounds = Reb,
      Assists = Ast,
      'Offensive Rebounds' = Off_reb,
      'Defensive Rebounds' = Def_reb,
      'Rim%' = Rim.,
      'Mid%' = Mid.,
      '3pt%' = Three.,
      Steals = Stl,
      Blocks = Blk,
      Turnovers = Tov,
      'FG%' = FG.,
      'eFG%' = eFG.,
      '2pt%' = Two.,
      'Points per Shot' = PPS,
      'Assists per 100 Turnovers' = Ast_Tov,
      'Assists per 100 FGA' = Ast_FGA,
      'Rim Attempt Rate' = Rim_att,
      'Mid Attempt Rate' = Mid_att,
      '3pt Attempt Rate' = Three_att
    ) %>%
    separate(Player, into = c('FirstName', 'LastName'), sep = " ", convert = TRUE) %>%
    slice(-n())
  data[is.na(data)] = 0
  return(data)
}
ShotChatFunct <- function(data) {
  data <- data %>%
    mutate(
      Rim = paste0(Rim_Make, '/', Rim_Make+Rim_Miss),
      Rim. = round((Rim_Make/(Rim_Make+Rim_Miss))*100,1),
      Paint = paste0(Paint_Make, '/', Paint_Make+Paint_Miss),
      Paint. = round((Paint_Make/(Paint_Make+Paint_Miss))*100,1),
      MidLC = paste0(MidLC_Make, '/', MidLC_Make+MidLC_Miss),
      MidLC. = round((MidLC_Make/(MidLC_Make+MidLC_Miss))*100,1),
      MidLW = paste0(MidLW_Make, '/', MidLW_Make+MidLW_Miss),
      MidLW. = round((MidLW_Make/(MidLW_Make+MidLW_Miss))*100,1),
      MidRW = paste0(MidRW_Make, '/', MidRW_Make+MidRW_Miss),
      MidRW. = round((MidRW_Make/(MidRW_Make+MidRW_Miss))*100,1),
      MidRC = paste0(MidRC_Make, '/', MidRC_Make+MidRC_Miss),
      MidRC. = round((MidRC_Make/(MidRC_Make+MidRC_Miss))*100,1),
      ThreeLC = paste0(ThreeLC_Make, '/', ThreeLC_Make+ThreeLC_Miss),
      ThreeLC. = round((ThreeLC_Make/(ThreeLC_Make+ThreeLC_Miss))*100,1),
      ThreeLW = paste0(ThreeLW_Make, '/', ThreeLW_Make+ThreeLW_Miss),
      ThreeLW. = round((ThreeLW_Make/(ThreeLW_Make+ThreeLW_Miss))*100,1),
      ThreeTop = paste0(ThreeTop_Make, '/', ThreeTop_Make+ThreeTop_Miss),
      ThreeTop. = round((ThreeTop_Make/(ThreeTop_Make+ThreeTop_Miss))*100,1),
      ThreeRW = paste0(ThreeRW_Make, '/', ThreeRW_Make+ThreeRW_Miss),
      ThreeRW. = round((ThreeRW_Make/(ThreeRW_Make+ThreeRW_Miss))*100,1),
      ThreeRC = paste0(ThreeRC_Make, '/', ThreeRC_Make+ThreeRC_Miss),
      ThreeRC. = round((ThreeRC_Make/(ThreeRC_Make+ThreeRC_Miss))*100,1),
    )
  data[is.na(data)] = 0
  
  custom_color_scale <- function(values) {
    col_numeric(
      palette = c("white", "#7bafd4", '#7bafd4'),
      domain = c(0, 50, 100),
      na.color = "white"
    )(values)
  }
  end_data <- data %>%
    mutate(
      Rim_pred = custom_color_scale(Rim.),
      Paint_pred = custom_color_scale(Paint.),
      MidLC_pred = custom_color_scale(MidLC.),
      MidLW_pred = custom_color_scale(MidLW.),
      MidRW_pred = custom_color_scale(MidRW.),
      MidRC_pred = custom_color_scale(MidRC.),
      ThreeLC_pred = custom_color_scale(ThreeLC.),
      ThreeLW_pred = custom_color_scale(ThreeLW.),
      ThreeTop_pred = custom_color_scale(ThreeTop.),
      ThreeRW_pred = custom_color_scale(ThreeRW.),
      ThreeRC_pred = custom_color_scale(ThreeRC.)
    )
  return(end_data)
}
ShotChartPlot <- function(data) {
  court <- ggplot() +
    # Outline court
    geom_rect(aes(ymin = 0, ymax = -19, xmin = -8, xmax = -8), color = 'black', fill = NA) +
    geom_rect(aes(ymin = -19, ymax = -19, xmin = -8, xmax = 8), color = 'black', fill = NA) +
    geom_rect(aes(ymin = 0, ymax = -19, xmin = 8, xmax = 8), color = 'black', fill = NA) +
    # paint color
    geom_rect(aes(ymin = -19, ymax = 0, xmin = -8, xmax = 8), fill = data$Paint_pred, color = NA, alpha = 0.5) +
    # rim color
    geom_circle(aes(y0 = -4.5, x0 = 0, r = 4.5), fill = data$Rim_pred, color = NA, alpha = 1) +
    # mid left corner color
    geom_polygon(aes(x = c(-24.7, -8, -8, -25.76, -25.76),
                     y = c(-11, -11, 0, 0, -8)), fill = data$MidLC_pred, alpha = 0.5) +
    # mid right corner color
    geom_polygon(aes(x = c(24.7, 8, 8, 25.76, 25.76),
                     y = c(-11, -11, 0, 0, -8)), fill = data$MidRC_pred, alpha = 0.5) +
    # mid left wing color
    geom_polygon(aes(x = c(-8, 0, 0, -4, -8),
                     y = c(-19, -19, -27, -26.8, -25.8)), fill = data$MidLW_pred, alpha = 0.5) +
    geom_polygon(aes(x = c(-24.7, -8, -8, -10, -11, -12, -13, -13.5, -14, -14.5, -15, -16, -16.5, -17, -18, -19, -20, -21, -22),
                     y = c(-11, -11, -25.8, -25, -24.7, -24, -23.8, -23.4, -23, -22.8, -22.2, -21.8, -21.5, -21, -20.2, -19.3, -18.3, -17.2, -16)), fill = data$MidLW_pred, alpha = 0.5) +
    # mid right wing color
    geom_polygon(aes(x = c(8, 0, 0, 4, 8),
                     y = c(-19, -19, -27, -26.8, -25.8)), fill = data$MidRW_pred, alpha = 0.5) +
    geom_polygon(aes(x = c(24.7, 8, 8, 10, 11, 12, 13, 13.5, 14, 14.5, 15, 16, 16.5, 17, 18, 19, 20, 21, 22),
                     y = c(-11, -11, -25.8, -25, -24.7, -24, -23.8, -23.4, -23, -22.8, -22.2, -21.8, -21.5, -21, -20.2, -19.3, -18.3, -17.2, -16)), fill = data$MidRW_pred, alpha = 0.5) +
    # three left corner color
    geom_polygon(aes(x = c(-30, -25.8, -25.8, -24.5, -30),
                     y = c(0, 0, -8, -11, -11)), fill = data$ThreeLC_pred, alpha = 0.5) +
    # three right corner color
    geom_polygon(aes(x = c(30, 25.8, 25.8, 24.5, 30),
                     y = c(0, 0, -8, -11, -11)), fill = data$ThreeRC_pred, alpha = 0.5) +
    # three left wing color
    geom_polygon(aes(x = c(-30, -30, -24.5, -23, -22, -21, -20, -19, -13, -13),
                     y = c(-40, -11, -11, -14, -15.5, -17.2, -18.3, -19.3, -23.8, -40)), fill = data$ThreeLW_pred, alpha = 0.5) +
    # three right wing color
    geom_polygon(aes(x = c(30, 30, 24.5, 23, 22, 21, 20, 19, 13, 13),
                     y = c(-40, -11, -11, -14, -15.5, -17.2, -18.3, -19.3, -23.8, -40)), fill = data$ThreeRW_pred, alpha = 0.5) +
    # three top key color
    geom_polygon(aes(x = c(13, -13, -13, -10, -8, -5, -3, 0, 3, 5, 8, 10, 13),
                     y = c(-40, -40, -23.8, -25, -25.8, -26.3, -26.7, -27, -26.7, -26.3, -25.8, -25, -23.8)), fill = data$ThreeTop_pred, alpha = 0.5) +
    # rim text
    geom_text(aes(x = 0, y = -5), label = data$Rim, size = 5, color = "black", fontface = "bold") +
    geom_text(aes(x = 0, y = -7), label = paste0(data$Rim., "%"), size = 5, color = "black", fontface = "bold") +
    # paint text
    geom_text(aes(x = 0, y = -15), label = data$Paint, size = 5, color = "black", fontface = "bold") +
    geom_text(aes(x = 0, y = -17), label = paste0(data$Paint., "%"), size = 5, color = "black", fontface = "bold") +
    # mid left corner text
    geom_text(aes(x = -16.5, y = -5), label = data$MidLC, size = 5, color = "black", fontface = "bold") +
    geom_text(aes(x = -16.5, y = -7), label = paste0(data$MidLC., "%"), size = 5, color = "black", fontface = "bold") +
    # mid right corner text
    geom_text(aes(x = 16.5, y = -5), label = data$MidRC, size = 5, color = "black", fontface = "bold") +
    geom_text(aes(x = 16.5, y = -7), label = paste0(data$MidRC., "%"), size = 5, color = "black", fontface = "bold") +
    # mid left wing text
    geom_text(aes(x = -13, y = -17), label = data$MidLW, size = 5, color = "black", fontface = "bold") +
    geom_text(aes(x = -13, y = -19), label = paste0(data$MidLW., "%"), size = 5, color = "black", fontface = "bold") +
    # mid right wing text
    geom_text(aes(x = 13, y = -17), label = data$MidRW, size = 5, color = "black", fontface = "bold") +
    geom_text(aes(x = 13, y = -19), label = paste0(data$MidRW., "%"), size = 5, color = "black", fontface = "bold") +
    # three left corner text
    geom_text(aes(x = -33, y = -4), label = data$ThreeLC, size = 5, color = "black", fontface = "bold") +
    geom_text(aes(x = -33, y = -6), label = paste0(data$ThreeLC., "%"), size = 5, color = "black", fontface = "bold") +
    # three right corner text
    geom_text(aes(x = 33, y = -4), label = data$ThreeRC, size = 5, color = "black", fontface = "bold") +
    geom_text(aes(x = 33, y = -6), label = paste0(data$ThreeRC., "%"), size = 5, color = "black", fontface = "bold") +
    # three left wing text
    geom_text(aes(x = -23, y = -23), label = data$ThreeLW, size = 5, color = "black", fontface = "bold") +
    geom_text(aes(x = -23, y = -25), label = paste0(data$ThreeLW., "%"), size = 5, color = "black", fontface = "bold") +
    # three right wing text
    geom_text(aes(x = 23, y = -23), label = data$ThreeRW, size = 5, color = "black", fontface = "bold") +
    geom_text(aes(x = 23, y = -25), label = paste0(data$ThreeRW., "%"), size = 5, color = "black", fontface = "bold") +
    # three top key text
    geom_text(aes(x = 0, y = -30), label = data$ThreeTop, size = 5, color = "black", fontface = "bold") +
    geom_text(aes(x = 0, y = -32), label = paste0(data$ThreeTop., "%"), size = 5, color = "black", fontface = "bold") +
    # Backboard
    geom_segment(aes(y = -2, x = -3, yend = -2, xend = 3), color = "black") +
    # Hoop
    geom_circle(aes(y0 = -2.8, x0 = 0, r = 0.75), color = "black", fill = NA) +
    # Three-point line (arc)
    geom_arc(aes(y0 = 0, x0 = 0, r = 27, start = ((pi/2)+0.3), end = (((3*pi)/2)-0.3)), color = "black") +
    # Three-point line (sides)
    geom_segment(aes(y = 0, x = 25.76, yend = -8, xend = 25.76), color = "black") +
    geom_segment(aes(y = 0, x = -25.76, yend = -8, xend = -25.76), color = "black") +
    # Sidelines
    geom_segment(aes(y = 0, x = -30, yend = 0, xend = 30), color = "black") +
    geom_segment(aes(y = -40, x = -30, yend = -40, xend = 30), color = "black") +
    geom_segment(aes(y = 0, x = -30, yend = -40, xend = -30), color = "black") +
    geom_segment(aes(y = 0, x = 30, yend = -40, xend = 30), color = "black") +
    # Dotted rim circle
    geom_circle(aes(y0 = -4.5, x0 = 0, r = 4.5), color = "black", fill = NA, linetype = 'dotted') +
    # Left baseline & corner 3 line
    geom_segment(aes(y = -11, x = -30, yend = -11, xend = -8), color = "black", linetype = 'dotted') +
    # Right baseline & corner 3 line
    geom_segment(aes(y = -11, x = 8, yend = -11, xend = 30), color = "black", linetype = 'dotted') +
    # FT line to top key three
    geom_segment(aes(y = -19, x = 0, yend = -27, xend = 0), color = "black", linetype = 'dotted') +
    # Left wing three
    geom_segment(aes(y = -24, x = -13, yend = -40, xend = -13), color = "black", linetype = 'dotted') +
    # Right wing three
    geom_segment(aes(y = -24, x = 13, yend = -40, xend = 13), color = "black", linetype = 'dotted') +
    
    coord_fixed() +
    theme_void()
  return(court)
}
```

#shiny
```{r}
ui <- fluidPage(
  theme = "readable",
  tags$style(HTML('
    @import url("https://fonts.googleapis.com/css2?family=Franklin+Gothic+Medium&display=swap");

    body {
      background-color: #7bafd4;
      margin: 0;
      padding: 0;
      font-family: "Franklin Gothic Medium", "Arial Narrow", Arial, sans-serif;
    }
    .left-image {
      position: fixed;
      top: 0;
      left: 0;
      height: 100vh;
      width: 195px; /* Set the width of the left image */
    }
    .top-image {
      position: absolute;
      top: 0;
      left: 195px; /* Start directly to the right of the left image */
      width: auto; /* Adjust the width to fill the remaining space*/
      height: 235px;
    }
    .content {
      margin-left: 170px; /* Adjust the margin to fit the left image width */
      padding-top: 235px; /* Adjust the padding to fit the top image height */
      padding-left: 10px;
      padding-right: 10px;
    }
    .tabbable > .nav > li > a {
      color: white; /* Change tab text color */
      font-size: 24px; /* Change tab text size */
      font-family: "Franklin Gothic Medium", "Arial Narrow", Arial, sans-serif;
      background-color: #7bafd4; /* Change tab background color */
      text-decoration: underline; /* Underline text */
      font-weight: normal; /* Make text not bold */
    }
    .tabbable > .nav > li > a:hover {
      background-color: #13294B; /* Change tab background color on hover */
      color: white; /* Change tab text color on hover */
    }
    .tabbable > .nav > li[class=active] > a {
      background-color: #13294B; /* Change active tab background color */
      color: white; /* Change active tab text color */
    }
    .button-section {
      background-color: #8dbee0; /* Change background behind the buttons */
      padding: 5px;
      border-radius: 5px;
    }
    .button-section .btn {
      background-color: #13294b; /* Change button color */
      color: #ffffff; /* Ensure the text is white for contrast */
      font-family: "Franklin Gothic Medium", "Arial Narrow", Arial, sans-serif;
      border: none;
      padding: 10px 15px;
      margin: 5px;
      border-radius: 5px;
      font-size: 16px; /* Change button text size */
    }
    .button-section .btn:hover {
      background-color: #accfe8;
      color: #000000;
    }
    .custom-select-label {
      color: #13294b; /* Change select date text color */
      font-family: "Franklin Gothic Medium", "Arial Narrow", Arial, sans-serif;
      font-size: 18px; /* Change select date text size */
      margin-bottom: 5px; /* Adjust spacing between label and input */
    }
    .custom-daily-button {
      background-color: #13294b; /* Change button color */
      color: white; /* Change button text color */
      font-family: "Franklin Gothic Medium", "Arial Narrow", Arial, sans-serif;
      font-size: 18px; /* Change button text size */
    }
    .date-input-wrapper {
      display: flex;
      flex-direction: column;
    }
  ')),
  tags$img(src = "https://pbs.twimg.com/media/GO6xuubW8AABl1V?format=jpg&name=medium", class = "left-image"),
  tags$img(src = "https://pbs.twimg.com/media/GbAOaEZbQAM3fej?format=jpg&name=medium", class = "top-image"),
  div(class = "content",
      tabsetPanel(
        tabPanel(
          'Practice Tables',
          div(class = 'button-section',
              fluidRow(
                column(3, align = 'center', actionButton('DailyButton', 'Daily')),
                column(3, align = 'center', actionButton('WeeklyButton', 'Weekly')),
                column(3, align = 'center', actionButton('MonthlyButton', 'Monthly')),
                column(3, align = 'center', actionButton('TotalButton', 'Total'))
              )
          ),
          fluidRow(
            column(3, uiOutput('TableInputUI'), uiOutput('TableButtons')),
            column(9, align = 'left', uiOutput('TableOutput'))
          )
        ),
        tabPanel(
          'Player Stats',
          div(class = 'button-section',
              fluidRow(
                column(4, align = 'center', actionButton('LineChartButton', 'Line Charts')),
                column(4, align = 'center', actionButton('RadarChartButton', 'Radar Charts')),
                column(4, align = 'center', actionButton('ScatterPlotButton', 'Scatter Plots'))
                )
              ),
          fluidRow(
            column(12, uiOutput('ChartInputUI')),
            column(12, align = 'center', uiOutput('ChartOutput'))
          )
          ),
        tabPanel(
          'Practice Reports',
          div(class = 'button-section',
              fluidRow(
                column(6, align = 'center', actionButton('PlayerReportsButton', 'Player Reports')),
                column(6, align = 'center', actionButton('WeeklyTeamReportsButton', 'Weekly Team Reports'))
              )
          ),
          fluidRow(
            column(12, uiOutput('PracticeReportsInputUI')),
            column(12, align = 'center', gt_output('InputText')),
            column(12, align = 'center', uiOutput('PracticeReportsOutput'))
          )
        ),
        tabPanel(
          'Shot Charts',
          div(class = 'button-section',
              fluidRow(
                column(3, align = 'center', actionButton('DailyShotChartButton', 'Daily')),
                column(3, align = 'center', actionButton('WeeklyShotChartButton', 'Weekly')),
                column(3, align = 'center', actionButton('MonthlyShotChartButton', 'Monthly')),
                column(3, align = 'center', actionButton('TotalShotChartButton', 'Total'))
              )
              ),
          fluidRow(
            column(6, align = 'left', uiOutput('PlayerSelectShotChartUI')),
            column(6, align = 'left', uiOutput('DateSelectShotChartUI')),
            column(12, align = 'center', uiOutput('ShotChartOutputUI'))
          )
        ),
        tabPanel(
          'Practice Reports',
          div(class = 'button-section',
              fluidRow(
                column(3, align = 'center', actionButton('DailyReport', 'Daily')),
                column(3, align = 'center', actionButton('WeeklyReport', 'Weekly')),
                column(3, align = 'center', actionButton('MonthlyReport', 'Monthly')),
                column(3, align = 'center', actionButton('PlayerReport', 'Player'))
              )
          ),
          fluidRow(
            column(3, uiOutput('ReportInputUI')),
            column(9, align = 'left', uiOutput('ReportOutput'))
          )
        )
        )
      )
  )

server <- function(input, output) {
  tbl_image_df <- data.frame(Jordan = 'https://i.ebayimg.com/images/g/KKcAAOSw6H5aldKt/s-l1200.jpg', UNC = 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcS4mzq28OohMYhB1tErXqobuNlBt2pdAM_OLdJaCwxVkA&s', Heel = 'https://pbs.twimg.com/media/GNuc3G1XoAA8TIz?format=png&name=240x240')
  #--------Session--------------------------------------------------
  observeEvent(input$DailyButton, {
    output$TableInputUI <- renderUI({
      tagList(
        div(class = "date-input-wrapper",
            HTML("<label class='custom-select-label'>Select Date:</label>"),
            dateInput("selectedDate", value = Sys.Date(), label = NULL, format = "mm-dd-yyyy")
        )
      )
    })
    output$TableButtons <- renderUI({
      tagList(
        actionButton('BasicButton_D', 'Basic Totals', class = "custom-daily-button"),
        actionButton('EfficiencyButton_D', 'Efficiency Table', class = "custom-daily-button")
      )
    })
  })
  observeEvent(input$WeeklyButton, {
    output$TableInputUI <- renderUI({
      tagList(
        div(class = "date-input-wrapper",
            HTML("<label class='custom-select-label'>Select Week:</label>"),
            selectInput('selectedWeek', label = NULL, choices = c('10.28 - 11.03'))
        )
      )
    })
    output$TableButtons <- renderUI({
      tagList(
        actionButton('BasicButton_W', 'Basic Totals', class = "custom-daily-button"),
        actionButton('EfficiencyButton_W', 'Efficiency Table', class = "custom-daily-button")
      )
    })
  })
  observeEvent(input$MonthlyButton, {
    output$TableInputUI <- renderUI({
      tagList(
        div(class = "date-input-wrapper",
            HTML("<label class='custom-select-label'>Select Month:</label>"),
            selectInput('selectedMonth', label = NULL, choices = c('November'))
        )
      )
    })
    output$TableButtons <- renderUI({
      tagList(
        actionButton('BasicButton_M', 'Basic Totals', class = "custom-daily-button"),
        actionButton('EfficiencyButton_M', 'Efficiency Table', class = "custom-daily-button")
      )
    })
  })
  observeEvent(input$TotalButton, {
    output$TableInputUI <- renderUI({})
    output$TableButtons <- renderUI({
      tagList(
        actionButton('BasicButton_T', 'Basic Totals', class = "custom-daily-button"),
        actionButton('EfficiencyButton_T', 'Efficiency Table', class = "custom-daily-button")
      )
    })
  })
  observeEvent(input$LineChartButton, {
    output$ChartInputUI <- renderUI({
      fluidRow(
        column(6,
               div(class = "date-input-wrapper",
                   HTML("<label class='custom-select-label'>Select Player:</label>"),
                   selectInput('selectedLineChartPlayer', label = NULL, choices = c('Totals', 'Sydney Barker', 'Trayanna Crisp', 'Lexi Donarski', 'Maria Gakdeng', 'Lanie Grant', 'Laila Hull', 'Reniya Kelly', 'Kayla McPherson', 'Indya Nivar', 'Blanca Thomas', 'Ciera Toomey', 'Grace Townsend', 'Alyssa Ustby', 'Jordan Zubich')))
               ),
        column(6,
               div(class = "date-input-wrapper",
                   HTML("<label class='custom-select-label'>Select Stat:</label>"),
                   selectInput('selectedLineChartStat', label = NULL, choices = c('Points', 'Assists', 'Rebounds', 'Offensive Rebounds', 'Defensive Rebounds', 'Steals', 'Blocks', 'Turnovers', 'FG%', 'eFG%', 'Rim%', 'Mid%', '2pt%', '3pt%', 'Rim Attempt Rate', 'Mid Attempt Rate', '3pt Attempt Rate', 'Points per Shot', 'Assists per 100 Turnovers', 'Assists per 100 FGA', 'Shots Made', 'Shots Attempted', 'Rim Makes', 'Rim Attempts', 'Mid Makes', 'Mid Attempts', '3pt Makes', '3pt Attempts', '2pt Makes', '2pt Attempts')))
               )
        )
      })
    output$ChartOutput <- renderUI({
      plotOutput('LineChart')
    })
    })
  observeEvent(input$RadarChartButton, {
    output$ChartInputUI <- renderUI({
      fluidRow(
        column(12, offset = 4,
               div(class = "date-input-wrapper",
                   HTML("<label class='custom-select-label'>Select Player:</label>"),
                   selectInput('selectedRadarChartPlayer', label = NULL, choices = c('Totals', 'Sydney Barker', 'Trayanna Crisp', 'Lexi Donarski', 'Maria Gakdeng', 'Lanie Grant', 'Laila Hull', 'Reniya Kelly', 'Kayla McPherson', 'Indya Nivar', 'Blanca Thomas', 'Ciera Toomey', 'Grace Townsend', 'Alyssa Ustby', 'Jordan Zubich'), selected = 'Totals'))
               )
      )
    })
    output$ChartOutput <- renderUI({
      fluidRow(
        column(6, plotOutput('RadarChart1', height = "473px", width = '413px')),
        column(6, plotOutput('RadarChart2', height = '473px', width = '425px'))
      )
    })
  })
  observeEvent(input$ScatterPlotButton, {
    output$ChartInputUI <- renderUI({
      fluidRow(
        column(6,
               div(class = "date-input-wrapper",
                   HTML("<label class='custom-select-label'>X-Axis Stat:</label>"),
                   selectInput('selectedXAxisStat', label = NULL, choices = c('Points', 'Assists', 'Rebounds', 'Offensive Rebounds', 'Defensive Rebounds', 'Steals', 'Blocks', 'Turnovers', 'FG%', 'eFG%', 'Rim%', 'Mid%', '2pt%', '3pt%', 'Rim Attempt Rate', 'Mid Attempt Rate', '3pt Attempt Rate', 'Points per Shot', 'Assists per 100 Turnovers', 'Assists per 100 FGA', 'Shots Made', 'Shots Attempted', 'Rim Makes', 'Rim Attempts', 'Mid Makes', 'Mid Attempts', '3pt Makes', '3pt Attempts', '2pt Makes', '2pt Attempts')))
               ),
        column(6,
               div(class = "date-input-wrapper",
                   HTML("<label class='custom-select-label'>Y-Axis Stat:</label>"),
                   selectInput('selectedYAxisStat', label = NULL, choices = c('Points', 'Assists', 'Rebounds', 'Offensive Rebounds', 'Defensive Rebounds', 'Steals', 'Blocks', 'Turnovers', 'FG%', 'eFG%', 'Rim%', 'Mid%', '2pt%', '3pt%', 'Rim Attempt Rate', 'Mid Attempt Rate', '3pt Attempt Rate', 'Points per Shot', 'Assists per 100 Turnovers', 'Assists per 100 FGA', 'Shots Made', 'Shots Attempted', 'Rim Makes', 'Rim Attempts', 'Mid Makes', 'Mid Attempts', '3pt Makes', '3pt Attempts', '2pt Makes', '2pt Attempts')))
               )
      )
    })
    output$ChartOutput <- renderUI({
      plotOutput('ScatterPlot')
    })
  })
  observeEvent(input$PlayerReportsButton, {
    output$PracticeReportsInputUI <- renderUI({
      fluidRow(
        column(6,
               div(class = 'date-input-wrapper',
                   HTML("<label class='custom-select-label'>Select Player:</label>"),
                   selectInput('SelectedPlayerReport', label = NULL, choices = c('Totals', 'Sydney Barker', 'Trayanna Crisp', 'Lexi Donarski', 'Maria Gakdeng', 'Lanie Grant', 'Laila Hull', 'Reniya Kelly', 'Kayla McPherson', 'Indya Nivar', 'Blanca Thomas', 'Ciera Toomey', 'Grace Townsend', 'Alyssa Ustby', 'Jordan Zubich')))
               )
      )
    })
    output$PracticeReportsOutput <- renderUI({
      downloadButton("downloadPlayerReport", "Download PDF",
                     style = "padding: 15px 25px; font-size: 18px; color: white; background-color: #13294b; border: 2px solid white; border-radius: 5px;")
    })
  })
  observeEvent(input$WeeklyTeamReportsButton, {
    output$PracticeReportsInputUI <- renderUI({
      fluidRow(
        column(6,
               div(class = 'date-input-wrapper',
                   HTML("<label class='custom-select-label'>Select Week:</label>"),
                   selectInput('SelectedWeekReport', label = NULL, choices = c('10.28 - 11.03')))
               )
      )
    })
    output$PracticeReportsOutput <- renderUI({
      downloadButton("downloadWeekReport", "Download PDF",
                     style = "padding: 15px 25px; font-size: 18px; color: white; background-color: #13294b; border: 2px solid white; border-radius: 5px;")
    })
  })
  observeEvent(input$DailyShotChartButton, {
    output$DateSelectShotChartUI <- renderUI({
      div(class = "date-input-wrapper",
          HTML("<label class='custom-select-label'>Select Date:</label>"),
          dateInput("selectedDateSC", value = Sys.Date(), label = NULL, format = "mm-dd-yyyy")
      )
    })
    output$PlayerSelectShotChartUI <- renderUI({
      div(class = "date-input-wrapper",
          HTML("<label class='custom-select-label'>Select Player:</label>"),
          selectInput('selectedShotChartPlayerD', label = NULL, choices = c('Totals', 'Sydney Barker', 'Trayanna Crisp', 'Lexi Donarski', 'Maria Gakdeng', 'Lanie Grant', 'Laila Hull', 'Reniya Kelly', 'Kayla McPherson', 'Indya Nivar', 'Blanca Thomas', 'Ciera Toomey', 'Grace Townsend', 'Alyssa Ustby', 'Jordan Zubich'))
      )
    })
    output$ShotChartOutputUI <- renderUI({
      plotOutput('DailyShotChart', height = '400px', width = '470px')
    })
  })
  observeEvent(input$WeeklyShotChartButton, {
    output$DateSelectShotChartUI <- renderUI({
      tagList(
        div(class = "date-input-wrapper",
            HTML("<label class='custom-select-label'>Select Week:</label>"),
            selectInput('selectedWeekSC', label = NULL, choices = c('10.28 - 11.03'), selected = '10.28 - 11.03')
        )
      )
    })
    output$PlayerSelectShotChartUI <- renderUI({
      div(class = "date-input-wrapper",
          HTML("<label class='custom-select-label'>Select Player:</label>"),
          selectInput('selectedShotChartPlayerW', label = NULL, choices = c('Totals', 'Sydney Barker', 'Trayanna Crisp', 'Lexi Donarski', 'Maria Gakdeng', 'Lanie Grant', 'Laila Hull', 'Reniya Kelly', 'Kayla McPherson', 'Indya Nivar', 'Blanca Thomas', 'Ciera Toomey', 'Grace Townsend', 'Alyssa Ustby', 'Jordan Zubich'), selected = 'Totals')
      )
    })
    output$ShotChartOutputUI <- renderUI({
      plotOutput('WeeklyShotChart', height = '400px', width = '470px')
    })
  })
  observeEvent(input$MonthlyShotChartButton, {
    output$DateSelectShotChartUI <- renderUI({
      tagList(
        div(class = "date-input-wrapper",
            HTML("<label class='custom-select-label'>Select Month:</label>"),
            selectInput('selectedMonthSC', label = NULL, choices = c('November'), selected = 'November')
        )
      )
    })
    output$PlayerSelectShotChartUI <- renderUI({
      div(class = "date-input-wrapper",
          HTML("<label class='custom-select-label'>Select Player:</label>"),
          selectInput('selectedShotChartPlayerM', label = NULL, choices = c('Totals', 'Sydney Barker', 'Trayanna Crisp', 'Lexi Donarski', 'Maria Gakdeng', 'Lanie Grant', 'Laila Hull', 'Reniya Kelly', 'Kayla McPherson', 'Indya Nivar', 'Blanca Thomas', 'Ciera Toomey', 'Grace Townsend', 'Alyssa Ustby', 'Jordan Zubich'), selected = 'Totals')
      )
    })
    output$ShotChartOutputUI <- renderUI({
      plotOutput('MonthlyShotChart', height = '400px', width = '470px')
    })
  })
  observeEvent(input$TotalShotChartButton, {
    output$DateSelectShotChartUI <- renderUI({})
    output$PlayerSelectShotChartUI <- renderUI({
      div(class = "date-input-wrapper",
          HTML("<label class='custom-select-label'>Select Player:</label>"),
          selectInput('selectedShotChartPlayerT', label = NULL, choices = c('Totals', 'Sydney Barker', 'Trayanna Crisp', 'Lexi Donarski', 'Maria Gakdeng', 'Lanie Grant', 'Laila Hull', 'Reniya Kelly', 'Kayla McPherson', 'Indya Nivar', 'Blanca Thomas', 'Ciera Toomey', 'Grace Townsend', 'Alyssa Ustby', 'Jordan Zubich'), selected = 'Totals')
      )
    })
    output$ShotChartOutputUI <- renderUI({
      plotOutput('TotalShotChart', height = '400px', width = '470px')
    })
  })
  observeEvent(input$DailyReport, {
    output$ReportInputUI <- renderUI({
      tagList(
        div(class = "date-input-wrapper",
            HTML("<label class='custom-select-label'>Select Date:</label>"),
            dateInput("selectedReportDate", value = Sys.Date(), label = NULL, format = "mm-dd-yyyy")
        )
      )
    })
    output$ReportOutput <- renderUI({
      plotOutput('DailyReportPNG')
    })
  })
  observeEvent(input$WeeklyReport, {
    output$ReportInputUI <- renderUI({
      tagList(
        div(class = "date-input-wrapper",
            HTML("<label class='custom-select-label'>Select Week:</label>"),
            selectInput('selectedReportWeek', label = NULL, choices = c('10.28 - 11.03'))
        )
      )
    })
    output$ReportOutput <- renderUI({
      plotOutput('WeeklyReportPNG')
    })
  })
  observeEvent(input$MonthlyReport, {
    output$ReportInputUI <- renderUI({
      tagList(
        div(class = "date-input-wrapper",
            HTML("<label class='custom-select-label'>Select Month:</label>"),
            selectInput('selectedReportMonth', label = NULL, choices = c('November'))
        )
      )
    })
    output$ReportOutput <- renderUI({
      plotOutput('MonthlyReportPNG')
    })
  })
  observeEvent(input$PlayerReport, {
    output$ReportInputUI <- renderUI({
      div(class = "date-input-wrapper",
          HTML("<label class='custom-select-label'>Select Player:</label>"),
          selectInput('selectedReportPlayer', label = NULL, choices = c('Sydney Barker', 'Trayanna Crisp', 'Lexi Donarski', 'Maria Gakdeng', 'Lanie Grant', 'Laila Hull', 'Reniya Kelly', 'Kayla McPherson', 'Indya Nivar', 'Blanca Thomas', 'Ciera Toomey', 'Grace Townsend', 'Alyssa Ustby', 'Jordan Zubich'), selected = 'Sydney Barker')
      )
    })
    output$ReportOutput <- renderUI({
      plotOutput('PlayerReportPNG')
    })
  })
  #-------Daily Table Output----------------------------------------------------
  observeEvent(input$selectedDate, {
    selected_date <- input$selectedDate
    data_name <- paste0(selected_date, ' | Practice Stats.csv')
    if (file.exists(data_name)) {
      observeEvent(input$BasicButton_D, {
        data <- read.csv(data_name)
        data <- BASIC_TABLES(data) 
        output$TableOutput <- render_gt({
          title <- glue('Practice Stats - Basic Totals')
          subtitle <- glue('{format(as.Date(selected_date), "%m/%d/%Y")}')
          title_header <- glue(
            "<div style='display: flex; justify-content: space-between; align-items: center; background-color: #ffffff; padding: 10px; border-radius: 5px;'>
              <div>
                <img src='{tbl_image_df$UNC}' style='height: 65px; width: auto; vertical-align: middle;'>
              </div>
              <div style='flex-grow: 1; text-align: center;'>
                <span style='font-family: Arial, sans-serif; font-weight: bold; font-size: 32px; line-height: 1.2; text-decoration: underline;'>{title}</span><br>
                <span style='font-family: Arial, serif; font-size: 18px; font-weight: normal; line-height: 1.2; font-style: italic;'>{subtitle}
                  <img src='{tbl_image_df$Heel}' style='height: 40px; width: auto; vertical-align: middle; margin-left: 5px;'>
                </span>
              </div>
              <div>
                <img src='{tbl_image_df$Jordan}' style='height: 65px; width: auto; vertical-align: middle;'>
              </div>
            </div>"
          )
          data <- data %>%
            gt() %>%
            tab_header(title = md(title_header)) %>%
            gt_highlight_rows(rows = c(15), fill = 'gray95') %>%
            text_transform(locations = cells_body(vars(image)), fn = function(x) {web_image(url = x, height = px(35))}) %>%
            cols_label(image = '', Player = md('**Player**'), Points = md('**PTS**'), Reb = md('**REB**'), Ast = md('**AST**'), Rim = md('**RIM**'), Rim. = md('**RIM%**'), Mid = md('**MID**'), Mid. = md('**MID%**'), Three = md('**3pt**'), Three. = md('**3pt%**'), Off_reb = md('**ORB**'), Def_reb = md('**DRB**'), Stl = md('**STL**'), Blk = md('**BLK**'), Tov = md('**TOV**')) %>%
            gt_add_divider(Ast, weight = px(3)) %>%
            gt_add_divider(Rim.) %>%
            gt_add_divider(Mid.) %>%
            gt_add_divider(Off_reb, sides = 'left', weight = px(3)) %>%
            data_color(columns = c(Rim.), palette = c("#ffffff", "#accfe8", "#7BAFD4")) %>%
            data_color(columns = c(Mid.), palette = c("#ffffff", "#accfe8", "#7BAFD4")) %>%
            data_color(columns = c(Three.), palette = c("#ffffff", "#accfe8", "#7BAFD4")) %>%
            cols_align(columns = c(image, Points, Reb, Ast, Rim, Rim., Mid, Mid., Three, Three., Off_reb, Def_reb, Stl, Blk, Tov), align = c('center')) %>%
            tab_spanner(label = md('*Shooting*'), columns = c(Rim, Rim., Mid, Mid., Three, Three.))
        })
      })
      observeEvent(input$EfficiencyButton_D, {
        data <- read.csv(data_name)
        data <- daily_table2(data)
        output$TableOutput <- render_gt({
          title <- glue('Practice Stats - Efficiency')
          subtitle <- glue('{format(as.Date(selected_date), "%m/%d/%Y")}')
          title_header <- glue(
            "<div style='display: flex; justify-content: space-between; align-items: center; background-color: #ffffff; padding: 10px; border-radius: 5px;'>
              <div>
                <img src='{tbl_image_df$UNC}' style='height: 65px; width: auto; vertical-align: middle;'>
              </div>
              <div style='flex-grow: 1; text-align: center;'>
                <span style='font-family: Arial, sans-serif; font-weight: bold; font-size: 32px; line-height: 1.2; text-decoration: underline;'>{title}</span><br>
                <span style='font-family: Arial, serif; font-size: 18px; font-weight: normal; line-height: 1.2; font-style: italic;'>{subtitle}
                  <img src='{tbl_image_df$Heel}' style='height: 40px; width: auto; vertical-align: middle; margin-left: 5px;'>
                </span>
              </div>
              <div>
                <img src='{tbl_image_df$Jordan}' style='height: 65px; width: auto; vertical-align: middle;'>
              </div>
            </div>"
          )
          data <- data %>%
            gt() %>%
            tab_header(title = md(title_header)) %>%
            gt_highlight_rows(rows = c(15), fill = 'gray95') %>%
            text_transform(locations = cells_body(vars(image)), fn = function(x) {web_image(url = x, height = px(35))}) %>%
            cols_label(image = '', Player = md('**Player**'), Points = md('**PTS**'), PPS = md('**PPS**'), FG = md('**FG**'), FG. = md('**FG%**'), eFG. = md('**eFG%**'), Two = md('**2pt**'), Two. = md('**2pt%**'), Three = md('**3pt**'), Three. = md('**3pt%**'), Ast_Tov = md('**Tov**'), Ast_FGA = md('**FGA**')) %>%
            tab_spanner(label = md('*Ast per 100*'), columns = c(Ast_Tov, Ast_FGA)) %>%
            cols_align(columns = c(image, Points, PPS, FG, FG., eFG., Two, Two., Three, Three., Ast_Tov, Ast_FGA), align = c('center')) %>%
            data_color(columns = c(FG.), palette = c("#ffffff", "#accfe8", "#7BAFD4")) %>%
            data_color(columns = c(eFG.), palette = c("#ffffff", "#accfe8", "#7BAFD4")) %>%
            data_color(columns = c(Two.), palette = c("#ffffff", "#accfe8", "#7BAFD4")) %>%
            data_color(columns = c(Three.), palette = c("#ffffff", "#accfe8", "#7BAFD4")) %>%
            gt_add_divider(eFG.) %>%
            gt_add_divider(Two., weight = px(1)) %>%
            gt_add_divider(Three.) %>%
            gt_add_divider(PPS)
        })
      })
    } else {
      no_df <- data.frame(one = 'No Stats Available For This Selected Date')
      observeEvent(input$BasicButton_D, {
        output$TableOutput <- render_gt({
          no_df <- no_df %>%
            gt() %>%
            cols_label(one = '') %>%
            tab_options(column_labels.hidden = TRUE) %>%
            tab_style(style = cell_text(weight = 'bold', color = 'black', size = px(36), align = 'center'), locations = cells_body())
          })
      })
      observeEvent(input$EfficiencyButton_D, {
        output$TableOutput <- render_gt({
          no_df <- no_df %>%
            gt() %>%
            cols_label(one = '') %>%
            tab_options(column_labels.hidden = TRUE) %>%
            tab_style(style = cell_text(weight = 'bold', color = 'black', size = px(36), align = 'center'), locations = cells_body())
          })
      })
    }
  })
  observeEvent(input$selectedWeek, {
    selected_week <- input$selectedWeek
    data_name <- paste0(selected_week, ' | Practice Stats.csv')
    if (file.exists(data_name)) {
      observeEvent(input$BasicButton_W, {
        data <- read.csv(data_name)
        data <- BASIC_TABLES(data)
        output$TableOutput <- render_gt({
          title <- glue('Practice Stats - Basic Totals')
          subtitle <- glue('{selected_week}')
          title_header <- glue(
            "<div style='display: flex; justify-content: space-between; align-items: center; background-color: #ffffff; padding: 10px; border-radius: 5px;'>
              <div>
                <img src='{tbl_image_df$UNC}' style='height: 65px; width: auto; vertical-align: middle;'>
              </div>
              <div style='flex-grow: 1; text-align: center;'>
                <span style='font-family: Arial, sans-serif; font-weight: bold; font-size: 32px; line-height: 1.2; text-decoration: underline;'>{title}</span><br>
                <span style='font-family: Arial, serif; font-size: 18px; font-weight: normal; line-height: 1.2; font-style: italic;'>{subtitle}
                  <img src='{tbl_image_df$Heel}' style='height: 40px; width: auto; vertical-align: middle; margin-left: 5px;'>
                </span>
              </div>
              <div>
                <img src='{tbl_image_df$Jordan}' style='height: 65px; width: auto; vertical-align: middle;'>
              </div>
            </div>"
          )
          data <- data %>%
            gt() %>%
            tab_header(title = md(title_header)) %>%
            gt_highlight_rows(rows = c(15), fill = 'gray95') %>%
            text_transform(locations = cells_body(vars(image)), fn = function(x) {web_image(url = x, height = px(35))}) %>%
            cols_label(image = '', Player = md('**Player**'), Points = md('**PTS**'), Reb = md('**REB**'), Ast = md('**AST**'), Rim = md('**RIM**'), Rim. = md('**RIM%**'), Mid = md('**MID**'), Mid. = md('**MID%**'), Three = md('**3pt**'), Three. = md('**3pt%**'), Off_reb = md('**ORB**'), Def_reb = md('**DRB**'), Stl = md('**STL**'), Blk = md('**BLK**'), Tov = md('**TOV**')) %>%
            gt_add_divider(Ast, weight = px(3)) %>%
            gt_add_divider(Rim.) %>%
            gt_add_divider(Mid.) %>%
            gt_add_divider(Off_reb, sides = 'left', weight = px(3)) %>%
            data_color(columns = c(Rim.), palette = c("#ffffff", "#accfe8", "#7BAFD4")) %>%
            data_color(columns = c(Mid.), palette = c("#ffffff", "#accfe8", "#7BAFD4")) %>%
            data_color(columns = c(Three.), palette = c("#ffffff", "#accfe8", "#7BAFD4")) %>%
            cols_align(columns = c(image, Points, Reb, Ast, Rim, Rim., Mid, Mid., Three, Three., Off_reb, Def_reb, Stl, Blk, Tov), align = c('center')) %>%
            tab_spanner(label = md('*Shooting*'), columns = c(Rim, Rim., Mid, Mid., Three, Three.))
        })
      })
      observeEvent(input$EfficiencyButton_W, {
        data <- read.csv(data_name)
        data <- WMT_Eff(data)
        output$TableOutput <- render_gt({
          title <- glue('Practice Stats - Efficiency')
          subtitle <- glue('{selected_week}')
          title_header <- glue(
            "<div style='display: flex; justify-content: space-between; align-items: center; background-color: #ffffff; padding: 10px; border-radius: 5px;'>
              <div>
                <img src='{tbl_image_df$UNC}' style='height: 65px; width: auto; vertical-align: middle;'>
              </div>
              <div style='flex-grow: 1; text-align: center;'>
                <span style='font-family: Arial, sans-serif; font-weight: bold; font-size: 32px; line-height: 1.2; text-decoration: underline;'>{title}</span><br>
                <span style='font-family: Arial, serif; font-size: 18px; font-weight: normal; line-height: 1.2; font-style: italic;'>{subtitle}
                  <img src='{tbl_image_df$Heel}' style='height: 40px; width: auto; vertical-align: middle; margin-left: 5px;'>
                </span>
              </div>
              <div>
                <img src='{tbl_image_df$Jordan}' style='height: 65px; width: auto; vertical-align: middle;'>
              </div>
            </div>"
          )
          data <- data %>%
            gt() %>%
            tab_header(title = md(title_header)) %>%
            gt_highlight_rows(rows = c(15), fill = 'gray95') %>%
            text_transform(locations = cells_body(vars(image)), fn = function(x) {web_image(url = x, height = px(35))}) %>%
            cols_label(image = '', Player = md('**Player**'), Points = md('**PTS**'), PPS = md('**PPS**'), FG = md('**FG**'), FG. = md('**FG%**'), eFG. = md('**eFG%**'), Two = md('**2pt**'), Two. = md('**2pt%**'), Three = md('**3pt**'), Three. = md('**3pt%**'), Ast_Tov = md('**Tov**'), Ast_FGA = md('**FGA**'), Rim_att = md('**Rim**'), Mid_att = md('**Mid**'), Three_att = md('**Three**')) %>%
            tab_spanner(label = md('*Ast per 100*'), columns = c(Ast_Tov, Ast_FGA)) %>%
            cols_align(columns = c(image, Points, PPS, FG, FG., eFG., Two, Two., Three, Three., Ast_Tov, Ast_FGA, Rim_att, Mid_att, Three_att), align = c('center')) %>%
            data_color(columns = c(FG.), palette = c("#ffffff", "#accfe8", "#7BAFD4")) %>%
            data_color(columns = c(eFG.), palette = c("#ffffff", "#accfe8", "#7BAFD4")) %>%
            data_color(columns = c(Two.), palette = c("#ffffff", "#accfe8", "#7BAFD4")) %>%
            data_color(columns = c(Three.), palette = c("#ffffff", "#accfe8", "#7BAFD4")) %>%
            gt_add_divider(eFG.) %>%
            gt_add_divider(Two., weight = px(1)) %>%
            gt_add_divider(Three.) %>%
            gt_add_divider(PPS) %>%
            gt_add_divider(Ast_FGA) %>%
            tab_spanner(label = md('*Attempts per 100 FGA*'), columns = c(Rim_att, Mid_att, Three_att))
        })
      })
    } else {
      no_df <- data.frame(one = 'No Stats Available For This Selected Date')
      observeEvent(input$BasicButton_W, {
        output$TableOutput <- render_gt({
          no_df <- no_df %>%
            gt() %>%
            cols_label(one = '') %>%
            tab_options(column_labels.hidden = TRUE) %>%
            tab_style(style = cell_text(weight = 'bold', color = 'black', size = px(36), align = 'center'), locations = cells_body())
          })
      })
      observeEvent(input$EfficiencyButton_W, {
        output$TableOutput <- render_gt({
          no_df <- no_df %>%
            gt() %>%
            cols_label(one = '') %>%
            tab_options(column_labels.hidden = TRUE) %>%
            tab_style(style = cell_text(weight = 'bold', color = 'black', size = px(36), align = 'center'), locations = cells_body())
          })
      })
    }
  })
  observeEvent(input$selectedMonth, {
    selected_month <- input$selectedMonth
    data_name <- paste0(selected_month, ' | Practice Stats.csv')
    if (file.exists(data_name)) {
      observeEvent(input$BasicButton_M, {
        data <- read.csv(data_name)
        data <- BASIC_TABLES(data)
        output$TableOutput <- render_gt({
          title <- glue('Practice Stats - Basic Totals')
          subtitle <- glue('{selected_month}')
          title_header <- glue(
            "<div style='display: flex; justify-content: space-between; align-items: center; background-color: #ffffff; padding: 10px; border-radius: 5px;'>
              <div>
                <img src='{tbl_image_df$UNC}' style='height: 65px; width: auto; vertical-align: middle;'>
              </div>
              <div style='flex-grow: 1; text-align: center;'>
                <span style='font-family: Arial, sans-serif; font-weight: bold; font-size: 32px; line-height: 1.2; text-decoration: underline;'>{title}</span><br>
                <span style='font-family: Arial, serif; font-size: 18px; font-weight: normal; line-height: 1.2; font-style: italic;'>{subtitle}
                  <img src='{tbl_image_df$Heel}' style='height: 40px; width: auto; vertical-align: middle; margin-left: 5px;'>
                </span>
              </div>
              <div>
                <img src='{tbl_image_df$Jordan}' style='height: 65px; width: auto; vertical-align: middle;'>
              </div>
            </div>"
          )
          data <- data %>%
            gt() %>%
            tab_header(title = md(title_header)) %>%
            gt_highlight_rows(rows = c(15), fill = 'gray95') %>%
            text_transform(locations = cells_body(vars(image)), fn = function(x) {web_image(url = x, height = px(35))}) %>%
            cols_label(image = '', Player = md('**Player**'), Points = md('**PTS**'), Reb = md('**REB**'), Ast = md('**AST**'), Rim = md('**RIM**'), Rim. = md('**RIM%**'), Mid = md('**MID**'), Mid. = md('**MID%**'), Three = md('**3pt**'), Three. = md('**3pt%**'), Off_reb = md('**ORB**'), Def_reb = md('**DRB**'), Stl = md('**STL**'), Blk = md('**BLK**'), Tov = md('**TOV**')) %>%
            gt_add_divider(Ast, weight = px(3)) %>%
            gt_add_divider(Rim.) %>%
            gt_add_divider(Mid.) %>%
            gt_add_divider(Off_reb, sides = 'left', weight = px(3)) %>%
            data_color(columns = c(Rim.), palette = c("#ffffff", "#accfe8", "#7BAFD4")) %>%
            data_color(columns = c(Mid.), palette = c("#ffffff", "#accfe8", "#7BAFD4")) %>%
            data_color(columns = c(Three.), palette = c("#ffffff", "#accfe8", "#7BAFD4")) %>%
            cols_align(columns = c(image, Points, Reb, Ast, Rim, Rim., Mid, Mid., Three, Three., Off_reb, Def_reb, Stl, Blk, Tov), align = c('center')) %>%
            tab_spanner(label = md('*Shooting*'), columns = c(Rim, Rim., Mid, Mid., Three, Three.))
        })
      })
      observeEvent(input$EfficiencyButton_M, {
        data <- read.csv(data_name)
        data <- WMT_Eff(data)
        output$TableOutput <- render_gt({
          title <- glue('Practice Stats - Efficiency')
          subtitle <- glue('{selected_month}')
          title_header <- glue(
            "<div style='display: flex; justify-content: space-between; align-items: center; background-color: #ffffff; padding: 10px; border-radius: 5px;'>
              <div>
                <img src='{tbl_image_df$UNC}' style='height: 65px; width: auto; vertical-align: middle;'>
              </div>
              <div style='flex-grow: 1; text-align: center;'>
                <span style='font-family: Arial, sans-serif; font-weight: bold; font-size: 32px; line-height: 1.2; text-decoration: underline;'>{title}</span><br>
                <span style='font-family: Arial, serif; font-size: 18px; font-weight: normal; line-height: 1.2; font-style: italic;'>{subtitle}
                  <img src='{tbl_image_df$Heel}' style='height: 40px; width: auto; vertical-align: middle; margin-left: 5px;'>
                </span>
              </div>
              <div>
                <img src='{tbl_image_df$Jordan}' style='height: 65px; width: auto; vertical-align: middle;'>
              </div>
            </div>"
          )
          data <- data %>%
            gt() %>%
            tab_header(title = md(title_header)) %>%
            gt_highlight_rows(rows = c(15), fill = 'gray95') %>%
            text_transform(locations = cells_body(vars(image)), fn = function(x) {web_image(url = x, height = px(35))}) %>%
            cols_label(image = '', Player = md('**Player**'), Points = md('**PTS**'), PPS = md('**PPS**'), FG = md('**FG**'), FG. = md('**FG%**'), eFG. = md('**eFG%**'), Two = md('**2pt**'), Two. = md('**2pt%**'), Three = md('**3pt**'), Three. = md('**3pt%**'), Ast_Tov = md('**Tov**'), Ast_FGA = md('**FGA**'), Rim_att = md('**Rim**'), Mid_att = md('**Mid**'), Three_att = md('**Three**')) %>%
            tab_spanner(label = md('*Ast per 100*'), columns = c(Ast_Tov, Ast_FGA)) %>%
            cols_align(columns = c(image, Points, PPS, FG, FG., eFG., Two, Two., Three, Three., Ast_Tov, Ast_FGA, Rim_att, Mid_att, Three_att), align = c('center')) %>%
            data_color(columns = c(FG.), palette = c("#ffffff", "#accfe8", "#7BAFD4")) %>%
            data_color(columns = c(eFG.), palette = c("#ffffff", "#accfe8", "#7BAFD4")) %>%
            data_color(columns = c(Two.), palette = c("#ffffff", "#accfe8", "#7BAFD4")) %>%
            data_color(columns = c(Three.), palette = c("#ffffff", "#accfe8", "#7BAFD4")) %>%
            gt_add_divider(eFG.) %>%
            gt_add_divider(Two., weight = px(1)) %>%
            gt_add_divider(Three.) %>%
            gt_add_divider(PPS) %>%
            gt_add_divider(Ast_FGA) %>%
            tab_spanner(label = md('*Attempts per 100 FGA*'), columns = c(Rim_att, Mid_att, Three_att))
        })
      })
    } else {
      no_df <- data.frame(one = 'No Stats Available For This Selected Date')
      observeEvent(input$BasicButton_M, {
        output$TableOutput <- render_gt({
          no_df <- no_df %>%
            gt() %>%
            cols_label(one = '') %>%
            tab_options(column_labels.hidden = TRUE) %>%
            tab_style(style = cell_text(weight = 'bold', color = 'black', size = px(36), align = 'center'), locations = cells_body())
          })
      })
      observeEvent(input$EfficiencyButton_M, {
        output$TableOutput <- render_gt({
          no_df <- no_df %>%
            gt() %>%
            cols_label(one = '') %>%
            tab_options(column_labels.hidden = TRUE) %>%
            tab_style(style = cell_text(weight = 'bold', color = 'black', size = px(36), align = 'center'), locations = cells_body())
          })
      })
    }
  })
  observeEvent(input$BasicButton_T, {
    data <- read.csv('Total Practice Stats.csv')
    data <- BASIC_TABLES(data)
    output$TableOutput <- render_gt({
      title <- glue('Practice Stats - Basic Totals')
      subtitle <- glue('Total Stats')
      title_header <- glue(
        "<div style='display: flex; justify-content: space-between; align-items: center; background-color: #ffffff; padding: 10px; border-radius: 5px;'>
          <div>
            <img src='{tbl_image_df$UNC}' style='height: 65px; width: auto; vertical-align: middle;'>
          </div>
          <div style='flex-grow: 1; text-align: center;'>
            <span style='font-family: Arial, sans-serif; font-weight: bold; font-size: 32px; line-height: 1.2; text-decoration: underline;'>{title}</span><br>
            <span style='font-family: Arial, serif; font-size: 18px; font-weight: normal; line-height: 1.2; font-style: italic;'>{subtitle}
              <img src='{tbl_image_df$Heel}' style='height: 40px; width: auto; vertical-align: middle; margin-left: 5px;'>
            </span>
          </div>
          <div>
            <img src='{tbl_image_df$Jordan}' style='height: 65px; width: auto; vertical-align: middle;'>
          </div>
        </div>"
      )
      data <- data %>%
        gt() %>%
        tab_header(title = md(title_header)) %>%
        gt_highlight_rows(rows = c(15), fill = 'gray95') %>%
        text_transform(locations = cells_body(vars(image)), fn = function(x) {web_image(url = x, height = px(35))}) %>%
        cols_label(image = '', Player = md('**Player**'), Points = md('**PTS**'), Reb = md('**REB**'), Ast = md('**AST**'), Rim = md('**RIM**'), Rim. = md('**RIM%**'), Mid = md('**MID**'), Mid. = md('**MID%**'), Three = md('**3pt**'), Three. = md('**3pt%**'), Off_reb = md('**ORB**'), Def_reb = md('**DRB**'), Stl = md('**STL**'), Blk = md('**BLK**'), Tov = md('**TOV**')) %>%
        gt_add_divider(Ast, weight = px(3)) %>%
        gt_add_divider(Rim.) %>%
        gt_add_divider(Mid.) %>%
        gt_add_divider(Off_reb, sides = 'left', weight = px(3)) %>%
        data_color(columns = c(Rim.), palette = c("#ffffff", "#accfe8", "#7BAFD4")) %>%
        data_color(columns = c(Mid.), palette = c("#ffffff", "#accfe8", "#7BAFD4")) %>%
        data_color(columns = c(Three.), palette = c("#ffffff", "#accfe8", "#7BAFD4")) %>%
        cols_align(columns = c(image, Points, Reb, Ast, Rim, Rim., Mid, Mid., Three, Three., Off_reb, Def_reb, Stl, Blk, Tov), align = c('center')) %>%
        tab_spanner(label = md('*Shooting*'), columns = c(Rim, Rim., Mid, Mid., Three, Three.))
    })
  })
  observeEvent(input$EfficiencyButton_T, {
    data <- read.csv('Total Practice Stats.csv')
    data <- WMT_Eff(data)
    output$TableOutput <- render_gt({
      title <- glue('Practice Stats - Efficiency')
      subtitle <- glue('Total Stats')
      title_header <- glue(
        "<div style='display: flex; justify-content: space-between; align-items: center; background-color: #ffffff; padding: 10px; border-radius: 5px;'>
          <div>
            <img src='{tbl_image_df$UNC}' style='height: 65px; width: auto; vertical-align: middle;'>
          </div>
          <div style='flex-grow: 1; text-align: center;'>
            <span style='font-family: Arial, sans-serif; font-weight: bold; font-size: 32px; line-height: 1.2; text-decoration: underline;'>{title}</span><br>
            <span style='font-family: Arial, serif; font-size: 18px; font-weight: normal; line-height: 1.2; font-style: italic;'>{subtitle}
              <img src='{tbl_image_df$Heel}' style='height: 40px; width: auto; vertical-align: middle; margin-left: 5px;'>
            </span>
          </div>
          <div>
            <img src='{tbl_image_df$Jordan}' style='height: 65px; width: auto; vertical-align: middle;'>
          </div>
        </div>"
      )
      data <- data %>%
        gt() %>%
        tab_header(title = md(title_header)) %>%
        gt_highlight_rows(rows = c(15), fill = 'gray95') %>%
        text_transform(locations = cells_body(vars(image)), fn = function(x) {web_image(url = x, height = px(35))}) %>%
        cols_label(image = '', Player = md('**Player**'), Points = md('**PTS**'), PPS = md('**PPS**'), FG = md('**FG**'), FG. = md('**FG%**'), eFG. = md('**eFG%**'), Two = md('**2pt**'), Two. = md('**2pt%**'), Three = md('**3pt**'), Three. = md('**3pt%**'), Ast_Tov = md('**Tov**'), Ast_FGA = md('**FGA**'), Rim_att = md('**Rim**'), Mid_att = md('**Mid**'), Three_att = md('**Three**')) %>%
        tab_spanner(label = md('*Ast per 100*'), columns = c(Ast_Tov, Ast_FGA)) %>%
        cols_align(columns = c(image, Points, PPS, FG, FG., eFG., Two, Two., Three, Three., Ast_Tov, Ast_FGA, Rim_att, Mid_att, Three_att), align = c('center')) %>%
        data_color(columns = c(FG.), palette = c("#ffffff", "#accfe8", "#7BAFD4")) %>%
        data_color(columns = c(eFG.), palette = c("#ffffff", "#accfe8", "#7BAFD4")) %>%
        data_color(columns = c(Two.), palette = c("#ffffff", "#accfe8", "#7BAFD4")) %>%
        data_color(columns = c(Three.), palette = c("#ffffff", "#accfe8", "#7BAFD4")) %>%
        gt_add_divider(eFG.) %>%
        gt_add_divider(Two., weight = px(1)) %>%
        gt_add_divider(Three.) %>%
        gt_add_divider(PPS) %>%
        gt_add_divider(Ast_FGA) %>%
        tab_spanner(label = md('*Attempts per 100 FGA*'), columns = c(Rim_att, Mid_att, Three_att))
    })
  })
  #-----------------Line Chart--------------------------------------------------
  observeEvent(input$selectedLineChartPlayer, {
    LineChart_Player <- input$selectedLineChartPlayer
    LineChart_csv <- paste0(LineChart_Player, ' | Daily Practice.csv')
    LineChart_df <- read.csv(LineChart_csv)
    LineChart_df <- LineChart(LineChart_df)
    output$LineChart <- renderPlot({
      selected_stat_LC <- input$selectedLineChartStat
      if (!is.null(selected_stat_LC)) {
        LC_df <- LineChart_df %>%
          select(num, all_of(selected_stat_LC))
        ggplot(LC_df, aes(x = num)) +
          geom_line(aes(y = .data[[selected_stat_LC]])) +
          geom_point(aes(y = .data[[selected_stat_LC]]), color = '#13294b', size = 2) +
          labs(title = paste0(LineChart_Player, ' | Practice Progress'), y = 'Value', x = '', subtitle = selected_stat_LC) +
          scale_color_manual(values = '#13294b') +
          theme_minimal() +
          theme(
            text = element_text(size = 12.5),
            axis.text = element_text(size = 14),
            axis.title.x = element_text(size = 15, face = 'bold'),
            axis.title.y = element_text(size = 15, face = 'bold'),
            axis.line = element_line(size = 1),
            plot.title = element_text(size = 17.5, face = 'bold', hjust = 0.5),
            plot.subtitle = element_text(size = 17.5, face = 'bold', hjust = 0.5),
            panel.grid = element_line(colour = 'gray80', linewidth = 0.5)
          )
      }
    })
  })
  #-------------Radar Charts----------------------------------------------------
  observeEvent(input$selectedRadarChartPlayer, {
    RadarPlayer <- input$selectedRadarChartPlayer
    RadarData <- read.csv('Total Practice Stats.csv')
    RadarData1 <- Radar1_1(RadarData)
    RadarData1 <- RadarData1 %>% filter(Player == RadarPlayer)
    RadarData1 <- Radar1_2(RadarData1)
    RadarData2 <- RadarData %>% filter(Player == RadarPlayer)
    RadarData2 <- Radar2(RadarData2, RadarData)
    output$RadarChart1 <- renderPlot({
      RadarChart1 <- ggplot(RadarData1, aes(x = Stat, y = Value)) +
        geom_col(aes(fill = Stat), width = 1, alpha = 0.9, color = 'white') +
        coord_polar(start = -pi/2, clip = 'off')
      RadarChart1 <- RadarChart1 +
        theme_minimal() +
        theme(panel.grid.major = element_line(color = "white", size = 0.5),
              plot.background = element_rect(fill = '#accfe8', color = '#accfe8'),
              legend.position = "none",
              axis.text.x = element_text(size = 18, face = "bold", color = "black"),
              axis.title.x = element_blank(),
              axis.title.y = element_blank(),
              axis.text.y = element_blank()) +
        labs(title = paste0(RadarPlayer, ' | Total Stats'),
             subtitle = paste0("Larger the area, the better they are performing\ncompared to rest of team.")) +
        theme(plot.title = element_text(hjust = 0.5, size = 20, face = 'bold', color = 'black'),
              plot.subtitle = element_text(color = 'black', size = 12, hjust = 0.5)) +
        scale_fill_manual(values = c('#13294b', '#13294b', '#13294b', '#13294b', '#13294b', '#13294b', '#13294b', '#13294b'), guide = 'none')
      print(RadarChart1)
    })
    output$RadarChart2 <- renderPlot({
      RadarChart2 <- ggplot(RadarData2, aes(x = Stat, y = Value)) +
        geom_col(aes(fill = Stat), width = 1, alpha = 0.9, color = 'white') +
        geom_point(aes(y = Avg), size = 3, color = 'black') +
        geom_segment(aes(x = Stat, y = 0, xend = Stat, yend = Avg), linetype = "dashed", color = "black") +
        coord_polar(start = -pi/2, clip = "off")
      RadarChart2 <- RadarChart2 +
        theme_minimal() +
        theme(
          panel.grid.major = element_line(color = "white", size = 0.5),
          plot.background = element_rect(fill = "#accfe8", color = '#accfe8'),
          legend.position = "none",
          axis.text.x = element_text(size = 18, face = "bold", color = "black"),
          axis.title.x = element_blank(),
          axis.title.y = element_blank(),
          axis.text.y = element_blank()
        ) + 
        labs(title = paste0(RadarPlayer, ' | Shooting Efficiency'),
             subtitle = paste0("Dotted line represents team average in practice.")
        ) + 
        theme(
          plot.title = element_text(hjust = 0.5, size = 20, face = "bold", color = 'black'),
          plot.subtitle = element_text(color = 'black', size = 12, hjust = 0.5)
        ) +
        scale_fill_manual(values = c('#13294b', '#13294b', '#13294b', '#13294b', '#13294b', '#13294b'), guide = 'none')
      print(RadarChart2)
    })
  })
  #---------------Scatter Plot--------------------------------------------------
  output$ScatterPlot <- renderPlot({
    x_stat <- as.character(input$selectedXAxisStat)
    y_stat <- as.character(input$selectedYAxisStat)
    ScatterData <- read.csv('Total Practice Stats.csv')
    ScatterData <- Scatter(ScatterData)
    ScatterPlot <- ggplot(ScatterData, aes(x = !!sym(x_stat), y = !!sym(y_stat))) +
      geom_point(size = 2, color = '#13294b') +
      geom_text(aes(label = FirstName), hjust = 0.5, vjust = -0.5, size = 6, fontface = 'bold') +
      labs(title = paste0(x_stat, ' vs. ', y_stat),
           x = x_stat, y = y_stat) +
      theme_minimal() +
      theme(
        plot.background = element_rect(fill = 'white'),
        axis.title.x = element_text(size = 15, face = 'bold'),
        axis.title.y = element_text(size = 15, face = 'bold'),
        plot.title = element_text(size = 20, face = 'bold', hjust = 0.5),
        axis.line = element_line(size = 0.5),
        panel.grid = element_line(colour = '#13294b', linewidth = 0.25),
        axis.text.x = element_text(size = 12, face = 'bold'),
        axis.text.y = element_text(size = 12, face = 'bold')
      )
    print(ScatterPlot)
  })
  #--------------Practice Reports-----------------------------------------------
  observeEvent(input$SelectedPlayerReport, {
    Player_Report <- input$SelectedPlayerReport
    PlayerReport_df <- data.frame(one = paste0(Player_Report, ' - Practice Report'))
    #PlayerReport_pdf_text <- paste0(Player_Report, ' | Practice Report.pdf')
    PlayerReport_pdf_text <- paste0('Test | Practice Report.pdf')
    output$InputText <- render_gt({
      tbl <- PlayerReport_df %>%
        gt() %>%
        cols_label(one = '') %>%
        tab_options(column_labels.hidden = TRUE) %>%
        tab_style(style = cell_text(weight = 'bold', color = 'black', size = px(18), align = 'center'), locations = cells_body())
    })
    output$downloadPlayerReport <- downloadHandler(
      filename = function() {
        PlayerReport_pdf_text
      },
      content = function(file) {
        file.copy(paste0("/Users/gregorylederer/Desktop/UNC Basketball/Shiny/24-25 Practice/", PlayerReport_pdf_text), file)
      }
    )
  })
  observeEvent(input$SelectedWeekReport, {
    Week_Report <- input$SelectedWeekReport
    WeekReport_df <- data.frame(one = paste0(Week_Report, ' - Practice Report'))
    WeekReport_pdf_text <- paste0(Week_Report, ' | Practice Report.pdf')
    output$InputText <- render_gt({
      tbl <- WeekReport_df %>%
        gt() %>%
        cols_label(one = '') %>%
        tab_options(column_labels.hidden = TRUE) %>%
        tab_style(style = cell_text(weight = 'bold', color = 'black', size = px(18), align = 'center'), locations = cells_body())
    })
    output$downloadWeekReport <- downloadHandler(
      filename = function() {
        WeekReport_pdf_text
      },
      content = function(file) {
        file.copy(paste0("/Users/gregorylederer/Desktop/UNC Basketball/Shiny/24-25 Practice/", WeekReport_pdf_text), file)
      }
    )
  })
  #---------Shot Charts---------------------------------------------------------
  observeEvent(input$selectedShotChartPlayerD, {
    SCd_player <- input$selectedShotChartPlayerD
    SCd_data <- paste0(SCd_player, ' | Shot Chart Data.csv')
    SCd_data <- read.csv(SCd_data)
    SCd_data$Day <- as.Date(SCd_data$Day, format = "%m.%d.%Y")
    SCd_data$Day <- format(SCd_data$Day, "%Y-%m-%d")
    observeEvent(input$selectedDateSC, {
      SC_date <- input$selectedDateSC
      SCd_data <- SCd_data %>% filter(Day == SC_date)
      if (nrow(SCd_data) == 0) {
        output$DailyShotChart <- renderPlot({
          ggplot() + 
            annotate("text", x = 0.5, y = 0.5, label = "No Data Available for\nthis Selected Date", size = 12, color = "black") + 
            theme_void() +
            labs(title = paste0(SCd_player, ' - Daily Shot Chart')) +
            theme(
              plot.title = element_text(hjust = 0.5, size = 16, face = "bold", color = "black")
            )
        })
      } else {
        SCd_data <- SCd_data %>% summarize(across(4:25, sum, na.rm = TRUE)) %>% mutate(Day = SC_date, Week = NA, Month = NA)
        SC_last_df <- ShotChatFunct(SCd_data)
        output$DailyShotChart <- renderPlot({
          court <- ShotChartPlot(SC_last_df) + 
            labs(
              title = paste0(SCd_player, ' - Daily Shot Chart'),
              subtitle = SC_date
            ) +
            theme(
              plot.title = element_text(hjust = 0.5, size = 16, face = "bold", color = "black"),
              plot.subtitle = element_text(hjust = 0.5, size = 12, face = "italic", color = "black")
            )
          print(court)
        })
      }
    })
  })
  observeEvent(list(input$selectedWeekSC, input$selectedShotChartPlayerW), {
    req(input$selectedWeekSC, input$selectedShotChartPlayerW)
    SC_week <- input$selectedWeekSC
    SCw_player <- as.character(input$selectedShotChartPlayerW)
    SCw_data <- paste0(SCw_player, ' | Shot Chart Data.csv')
    SCw_data <- read.csv(SCw_data)
    SCw_data <- SCw_data %>% filter(Week == SC_week)
    if (nrow(SCw_data) == 0) {
      output$WeeklyShotChart <- renderPlot({
        ggplot() + 
          annotate("text", x = 0.5, y = 0.5, label = "No Data Available for\nthe Selected Week", size = 12, color = "black") + 
          theme_void() +
          labs(title = paste0(SCw_player, ' - Weekly Shot Chart')) +
          theme(
            plot.title = element_text(hjust = 0.5, size = 16, face = "bold", color = "black")
          )
      })
    } else {
      SCw_data <- SCw_data %>% summarize(across(4:25, sum, na.rm = TRUE)) %>% mutate(Day = NA, Week = SC_week, Month = NA)
      SC_last_df <- ShotChatFunct(SCw_data)
      output$WeeklyShotChart <- renderPlot({
        court <- ShotChartPlot(SC_last_df) + 
          labs(
            title = paste0(SCw_player, ' - Weekly Shot Chart'),
            subtitle = SC_week
          ) +
          theme(
            plot.title = element_text(hjust = 0.5, size = 16, face = "bold", color = "black"),
            plot.subtitle = element_text(hjust = 0.5, size = 12, face = "italic", color = "black")
          )
        print(court)
      })
    }
  })
  observeEvent(list(input$selectedMonthSC, input$selectedShotChartPlayerM), {
    req(input$selectedMonthSC, input$selectedShotChartPlayerM)
    SC_month <- input$selectedMonthSC
    SCm_player <- as.character(input$selectedShotChartPlayerM)
    SCm_data <- paste0(SCm_player, ' | Shot Chart Data.csv')
    SCm_data <- read.csv(SCm_data)
    SCm_data <- SCm_data %>% filter(Month == SC_month)
    if (nrow(SCm_data) == 0) {
      output$MonthlyShotChart <- renderPlot({
        ggplot() + 
          annotate("text", x = 0.5, y = 0.5, label = "No Data Available for\nthe Selected Month", size = 12, color = "black") + 
          theme_void() +
          labs(title = paste0(SCm_player, ' - Monthly Shot Chart')) +
          theme(
            plot.title = element_text(hjust = 0.5, size = 16, face = "bold", color = "black")
          )
      })
    } else {
      SCm_data <- SCm_data %>% summarize(across(4:25, sum, na.rm = TRUE)) %>% mutate(Day = NA, Week = NA, Month = SC_month)
      SC_last_df <- ShotChatFunct(SCm_data)
      output$MonthlyShotChart <- renderPlot({
        court <- ShotChartPlot(SC_last_df) + 
          labs(
            title = paste0(SCm_player, ' - Monthly Shot Chart'),
            subtitle = SC_month
          ) +
          theme(
            plot.title = element_text(hjust = 0.5, size = 16, face = "bold", color = "black"),
            plot.subtitle = element_text(hjust = 0.5, size = 12, face = "italic", color = "black")
          )
        print(court)
      })
    }
  })
  observeEvent(input$selectedShotChartPlayerT, {
    req(input$selectedShotChartPlayerT)
    SCt_player <- input$selectedShotChartPlayerT
    SCt_data <- paste0(SCt_player, ' | Shot Chart Data.csv')
    SCt_data <- read.csv(SCt_data)
    if (nrow(SCt_data) == 0) {
      output$TotalShotChart <- renderPlot({
        ggplot() + 
          annotate("text", x = 0.5, y = 0.5, label = "No Data Available", size = 12, color = "black") + 
          theme_void() +
          labs(title = paste0(SCm_player, ' - Total Shot Chart')) +
          theme(
            plot.title = element_text(hjust = 0.5, size = 16, face = "bold", color = "black")
          )
      })
    } else {
      SCt_data <- SCt_data %>% summarize(across(4:25, sum, na.rm = TRUE)) %>% mutate(Day = NA, Week = NA, Month = NA)
      SC_last_df <- ShotChatFunct(SCt_data)
      output$TotalShotChart <- renderPlot({
        court <- ShotChartPlot(SC_last_df) + 
          labs(
            title = paste0(SCt_player, ' - Total Shot Chart')
          ) +
          theme(
            plot.title = element_text(hjust = 0.5, size = 16, face = "bold", color = "black")
          )
        print(court)
      })
    }
  })
  #---------------Practice Reports----------------------------------------------
  observeEvent(input$selectedReportDate, {
    selectedReportDate <- input$selectedReportDate
    daily_file_name <- paste0(selectedReportDate, ' | Prac Report.png')
    if (file.exists(daily_file_name)) {
      output$DailyReportPNG <- renderImage({
        list(src = daily_file_name,
             contentType = 'image/png',
             width = '60%',
             height = '160%')
      }, deleteFile = FALSE)
    } else {
      output$DailyReportPNG <- renderImage({
        list(src = 'No.png',
             contentType = 'image/png',
             width = '100%',
             height = '40%')
      }, deleteFile = FALSE)
    }
  })
  observeEvent(input$selectedReportWeek, {
    selectedReportWeek <- input$selectedReportWeek
    weekly_file_name <- paste0(selectedReportWeek, ' | Prac Report.png')
    if (file.exists(weekly_file_name)) {
      output$WeeklyReportPNG <- renderImage({
        list(src = weekly_file_name,
             contentType = 'image/png',
             width = '60%',
             height = '160%')
      }, deleteFile = FALSE)
    } else {
      output$WeeklyReportPNG <- renderImage({
        list(src = 'No.png',
             contentType = 'image/png',
             width = '100%',
             height = '40%')
      }, deleteFile = FALSE)
    }
  })
  observeEvent(input$selectedReportMonth, {
    selectedReportMonth <- input$selectedReportMonth
    monthly_file_name <- paste0(selectedReportMonth, ' | Prac Report.png')
    if (file.exists(monthly_file_name)) {
      output$MonthlyReportPNG <- renderImage({
        list(src = monthly_file_name,
             contentType = 'image/png',
             width = '60%',
             height = '160%')
      }, deleteFile = FALSE)
    } else {
      output$MonthlyReportPNG <- renderImage({
        list(src = 'No.png',
             contentType = 'image/png',
             width = '100%',
             height = '40%')
      }, deleteFile = FALSE)
    }
  })
  observeEvent(input$selectedReportPlayer, {
    selectedReportPlayer <- input$selectedReportPlayer
    player_file_name <- paste0(selectedReportPlayer, ' | Prac Report.png')
    if (file.exists(player_file_name)) {
      output$PlayerReportPNG <- renderImage({
        list(src = player_file_name,
             contentType = 'image/png',
             width = '20%',
             height = '160%')
      }, deleteFile = FALSE)
    } else {
      output$PlayerReportPNG <- renderImage({
        list(src = 'No.png',
             contentType = 'image/png',
             width = '100%',
             height = '40%')
      }, deleteFile = FALSE)
    }
  })
}

shinyApp(ui = ui, server = server)
```

